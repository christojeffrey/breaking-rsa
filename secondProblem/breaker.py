# known plaintext?
from Crypto.Util.number import GCD
# https://crypto.stackexchange.com/questions/93687/in-rsa-signing-find-n-from-e-and-many-pairs-of-m-and-c
# n: 120650887851760844584495360731316170396245060417504106455307929297922421725242397461889940015769143802611449611955763501767942949615127026656788784779486922277811442811189532384585850451517126945448166398031213359450593957173617077886615405259618535173352091680484392857999806372614514579222746595013626749377
# e: 50577
# d: 94004973358924799860434756516578213947146511178452346384410296574396047075283768447727165830346099013968985801023009911900059865462232056853195635205829532761173814076435841650045432769180171974093622777206837866452260729075337474520512842006582160840011155935234256593929933506703783486963573338218589022529
m1 = 2
c1 = 34555365311489454393562729078494149845071378246825440545211271984471997771185054797546467599304152290956767893549216765181097598379123659708770153624442043181912610665871531132160461723812688051221783540016843910707396662351944674902162690197222649224987672772259356389006647768879654121059797883558569624015


m2 = 3
c2 = 23235576771375437971086092642755413038183170363675565161680419093041303844749604550011396175696976527193040003085434172403033013524918667841398273200229704673376129599785598952945818457067116974722353729210943840926570253832926044690592057335628019943259749643924092701825405734948509814568416196590114217101

eLow = 2**15
eHigh = 2**16

# brute force find n

for e in range(eLow, eHigh + 1):
    print(e)
    firstPart = pow(m1, e) - c1
    secondPart = pow(m2, e) - c2
    multipleofn = GCD(firstPart, secondPart)
    if(multipleofn != 1 and multipleofn > 1000):
        print(multipleofn)
        print(e)
        break

# print(pow(m1, eLow))